(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[59],{8386:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return w}});var s=r(6687),n=r(9499),a=r(29),c=r(7794),l=r.n(c),i=r(7294),o=r(8325),d=r.n(o),m=(r(5433),r(4335),r(9980),r(6102),r(366),r(6854),r(9945),r(2503),r(4279),r(2731),r(6177),r(8759),r(2911),r(5206),r(6263),r(110),r(8533)),u=r(1163),p=r(3854),x=r(782),h=(r(4213),r(9008)),g=r.n(h),f=r(2918),b=r(5893);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var w=!0;t.default=function(e){var t=e.blog,r=e.errorCode,c=(0,u.useRouter)(),o=c.query.slug,h=(0,i.useState)({comment:"",reply:""}),y=h[0],w=h[1],v=(0,i.useState)(),N=v[0],k=v[1],O=(0,i.useState)(),S=O[0],C=O[1],_=(0,i.useState)(0),E=_[0],T=_[1],P=(0,i.useState)(),A=P[0],D=P[1],H=(0,i.useState)({state:!0}),J=H[0],Z=H[1],B=(0,i.useState)(),L=B[0],M=B[1],z=(0,i.useState)(),I=z[0],q=z[1],R=(0,i.useState)(),F=R[0],V=R[1],W=function(){var e=(0,a.Z)(l().mark((function e(){var t,r,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.codewithharry.com/api/dataapi/getcomments?start="+E+"&end=5&search="+o);case 2:return t=e.sent,T(E+5),e.next=6,t.json();case 6:r=e.sent,A?(s=(s=JSON.parse(JSON.stringify(A))).concat(r.comments),D(s)):D(r.comments),C(r.pageLen);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=(0,a.Z)(l().mark((function e(t){var r,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.codewithharry.com/api/dataapi/getreplies?search="+t);case 2:return r=e.sent,e.next=5,r.json();case 5:s=e.sent,"all"===t?q(s):M(s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(e){w(j(j({},y),{},(0,n.Z)({},e.target.name,e.target.value)))},U=function(){var e=(0,a.Z)(l().mark((function e(t){var r,n,a,c;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=JSON.parse(localStorage.getItem("myuser"))){e.next=5;break}return x.Am.error("You need to login first",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),e.abrupt("return");case 5:return n=t.target.id,e.next=8,fetch("https://www.codewithharry.com/api/postcomments",{method:"POST",headers:{"Content-Type":"application/json"},body:n?JSON.stringify({comment:y.reply,parent:n,token:r.token,blog:o,state:"published",securityToken:String(8*(new Date).getTime())}):JSON.stringify({comment:y.comment,token:r.token,blog:o,state:"published",securityToken:String(8*(new Date).getTime())})});case 8:return a=e.sent,w({comment:"",reply:""}),n?t.target.children[2].disabled=!0:t.target.children[0].children[2].children[0].children[0].disabled=!0,e.next=13,a.json();case 13:!0===(c=e.sent).success?(n?(M(L?function(e){return[].concat((0,s.Z)(e),[{comment:y.reply,parent:n,user:c.username,createdAt:(new Date).toJSON()}])}:[{comment:y.reply,parent:n,user:c.username,createdAt:(new Date).toJSON()}]),c.message="Reply Added!"):D((function(e){return[c.comment].concat((0,s.Z)(e))})),x.Am.success(c.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})):x.Am.error(c.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){setTimeout((function(){for(var e=document.getElementsByClassName("cwhads").length,t=0;t<e;t++){console.log("pushing");try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(r){}}}),0)}),[N]),(0,i.useEffect)((function(){Array.from(document.getElementsByClassName("copy-to-clipboard-button")).forEach((function(e){e.addEventListener("click",(function(e){e.target.innerText="Copied!";var t=e.target.parentElement.parentElement.parentElement.parentElement.getElementsByTagName("pre")[0].innerText;setTimeout((function(){e.target.innerText="Copy"}),1e3),navigator.clipboard.writeText(t)}))})),t&&k(function(e){var t=document.createElement("div");return t.innerHTML=e,d().manual=!0,d().highlightAllUnder(t),t.innerHTML}(t.content.replace(/&lt;\|AD\|&gt;/g,'<div class=\'cwhads my-4\'><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9655830461045889" data-ad-slot="8999979664" data-ad-format="auto" data-full-width-responsive="true"></ins></div>')))})),(0,i.useEffect)((function(){o&&W(),X("all");try{JSON.parse(localStorage.getItem("admin")).username||V(!0)}catch(e){V(!1)}}),[c.query]),r?(0,b.jsx)(f.default,{statusCode:r}):(0,b.jsxs)(b.Fragment,{children:[t&&(0,b.jsxs)(g(),{children:[(0,b.jsxs)("title",{children:[t.title," | CodeWithHarry"]}),(0,b.jsx)("meta",{name:"description",content:t.metadesc}),(0,b.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,b.jsx)(x.Ix,{}),(0,b.jsx)("div",{className:"my-5 mx-7",children:t&&(0,b.jsxs)("div",{className:"min-h-screen lg:mx-[20%] md:mx-[10%]",children:[(0,b.jsxs)("h1",{className:"text-2xl lg:text-3xl flex font-semibold",children:[t.title,F&&(0,b.jsx)("a",{href:"/dashboard/blogpost/"+o,target:"_blank",rel:"noreferrer",children:(0,b.jsx)(p.z2D,{})})]}),(0,b.jsx)("div",{className:"cont font-karla",dangerouslySetInnerHTML:{__html:N}}),(0,b.jsx)("hr",{className:"mt-10"}),(0,b.jsx)("div",{className:"flex items-center justify-center shadow-lg mt-10 border mb-7 max-w-lg rounded-lg",children:(0,b.jsx)("form",{className:"w-full max-w-xl bg-white rounded-lg px-4 pt-2",onSubmit:U,children:(0,b.jsxs)("div",{className:"flex flex-wrap -mx-3 mb-6",children:[(0,b.jsx)("h2",{className:"px-4 pt-3 pb-2 text-gray-800 text-lg",children:"Add a new comment"}),(0,b.jsx)("div",{className:"w-full md:w-full px-3 mb-2 mt-2",children:(0,b.jsx)("textarea",{value:y.comment,onChange:Y,className:"bg-gray-100 rounded border border-gray-400 leading-normal resize-none w-full h-20 py-2 px-3 font-medium placeholder-gray-700 focus:outline-none focus:bg-white",name:"comment",placeholder:"Type Your Comment",required:!0})}),(0,b.jsx)("div",{className:"w-full md:w-full flex items-start px-3",children:(0,b.jsx)("div",{className:"-mr-1",children:(0,b.jsx)("input",{type:"submit",className:"disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-default text-white bg-purple-700 hover:bg-purple-800 focus:ring-4 focus:ring-purple-300 font-medium rounded-lg text-sm px-3 py-2 text-center inline-flex items-center mx-1 cursor-pointer",value:"Post Comment"})})})]})})}),A&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("h3",{className:"mb-2 text-2xl font-semibold",children:["Comments (",S,")"]}),(0,b.jsx)("hr",{className:"mb-1"}),0==S&&(0,b.jsx)("div",{className:"m-3",children:"No comments found"}),(0,b.jsx)(m.Z,{dataLength:A.length,next:W,hasMore:A.length!==S,loader:(0,b.jsx)("div",{className:"flex items-center justify-center mt-6",children:(0,b.jsx)("div",{className:"inline-flex max-w-4xl mx-auto items-center px-4 py-2 leading-6 transition ease-in-out duration-150 cursor-not-allowed",children:(0,b.jsxs)("svg",{className:"animate-spin h-8 w-8 text-purple-700",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})}),children:A.map((function(e){return(0,b.jsx)("div",{className:"max-w-screen-sm px-4",children:(0,b.jsxs)("div",{className:"flex my-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0 mr-3",children:(0,b.jsx)("img",{src:"/img/user.png",alt:"",className:"mt-2 rounded-full w-8 h-8 sm:w-10 sm:h-10"})}),(0,b.jsxs)("div",{className:"flex-1 border rounded-lg px-4 py-2 sm:px-6 sm:py-4 leading-relaxed max-w-[75vw] break-words",children:[(0,b.jsx)("strong",{children:e.user}),(0,b.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:e.createdAt.slice(0,10)}),(0,b.jsx)("div",{className:"flex",children:(0,b.jsx)("p",{className:"text-sm mt-1",children:e.comment})}),I&&I.map((function(t){return e._id==t&&(0,b.jsx)("div",{className:"flex space-x-4",children:(0,b.jsx)("button",{className:"my-3 uppercase tracking-wide text-gray-400 font-bold text-xs cursor-pointer",onClick:function(){X(e._id)},children:"View all replies"})},t)})),L&&L.map((function(t){return e._id==t.parent&&(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)("div",{className:"flex-shrink-0 mr-3",children:(0,b.jsx)("img",{src:"/img/user.png",alt:"",className:"mt-3 rounded-full w-6 h-6 sm:w-8 sm:h-8"})}),(0,b.jsxs)("div",{className:"flex-1 bg-gray-100 mb-4 rounded-lg px-4 py-2 sm:px-6 sm:py-4 leading-relaxed",children:[(0,b.jsx)("strong",{children:t.user}),(0,b.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:t.createdAt.slice(0,10)}),(0,b.jsx)("p",{className:"text-xs sm:text-sm",children:t.comment})]})]})},t._id)})),(0,b.jsx)("button",{className:"mt-3 uppercase tracking-wide text-white bg-purple-600 rounded p-2 font-bold text-xs cursor-pointer ".concat(J.state?"block":"hidden"),onClick:function(){Z({state:!1,id:e._id})},children:"Reply"}),(0,b.jsx)("div",{className:"flex space-x-4",children:e._id==J.id&&(0,b.jsxs)("form",{onSubmit:U,className:"flex ".concat(J.state?"hidden":"block"),id:e._id,children:[(0,b.jsx)("div",{className:"flex-shrink-0 mr-3",children:(0,b.jsx)("img",{src:"/img/user.png",alt:"",className:"rounded-full w-6 h-6 sm:w-8 sm:h-8"})}),(0,b.jsx)("input",{type:"text",className:"border pl-2",name:"reply",value:y.reply,onChange:Y}),(0,b.jsx)("button",{type:"submit",className:"disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-default ml-2 hover:bg-purple-800 uppercase tracking-wide text-white bg-purple-600 rounded p-2 font-bold text-xs cursor-pointer",children:"Post"}),(0,b.jsx)("div",{className:"mt-2 ml-2 text-gray-600 uppercase tracking-wide active:text-purple-600 font-bold text-xs cursor-pointer",onClick:function(){Z({state:!0,id:e._id})},children:"Cancel"})]})})]})]})},e._id)}))})]})]})})]})}},8133:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blogpost/[slug]",function(){return r(8386)}])}},function(e){e.O(0,[556,353,189,993,774,888,179],(function(){return t=8133,e(e.s=t);var t}));var t=e.O();_N_E=t}]);